<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
  <title>{% block title %}Blunder Tutor{% endblock %}</title>

  <!-- Base CSS -->
  <link rel="stylesheet" href="/static/css/base.css">

  <!-- Theme loader - applies cached colors before page renders -->
  <script src="/static/js/theme-loader.js"></script>

  <!-- i18n: inject translations for client-side JS -->
  <script>
    window.__i18n__ = {{ translations_json|default('{}')|safe }};
    window.__locale__ = "{{ locale|default('en') }}";
  </script>
  <script src="/static/js/i18n.js"></script>

  <!-- Feature flags for client-side visibility -->
  <script>window.__features = {{ features_json|default('{}')|safe }};</script>

  <!-- HTMX for reactive components -->
  <script src="/static/vendor/htmx-1.9.10.min.js"></script>

  <!-- Page-specific CSS -->
  {% block extra_css %}{% endblock %}

  <!-- Page-specific head content -->
  {% block extra_head %}{% endblock %}
</head>
<body>
  {% block body %}
  <div class="container">
    {% block header %}
    <h1>{% block page_title %}Blunder Tutor{% endblock %}</h1>
    {% endblock %}

    {% block navigation %}{% endblock %}

    {% block content %}{% endblock %}
  </div>
  {% endblock %}

  <!-- Base JavaScript (jQuery for chessboard, if needed) -->
  {% block base_scripts %}{% endblock %}

  <!-- Theme sync - fetch from server and update cache -->
  <script src="/static/js/theme-sync.js"></script>

  <!-- Page-specific JavaScript -->
  {% block extra_scripts %}{% endblock %}
</body>
</html>
